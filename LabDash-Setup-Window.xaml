<?xml version="1.0" encoding="utf-8"?>
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Mizzle-AV - App Validation for Lab Dash"
        Height="600" Width="1000"
        WindowStartupLocation="CenterScreen"
        Background="#282a36" Foreground="#EEEEEE"
        FontFamily="Segoe UI" FontSize="13"
        ShowInTaskbar="True">
  <Window.Resources>
    <!-- Brand Colors -->
    <Color x:Key="MizzlePurple">#FF761BF6</Color>
    <Color x:Key="MizzleTeal">#FF29CCCC</Color>
    <Color x:Key="MizzleBlue">#FF08C0E8</Color>
    <Color x:Key="MizzlePink">#FFE91E63</Color>
    <SolidColorBrush x:Key="PurpleBrush" Color="{StaticResource MizzlePurple}"/>
    <SolidColorBrush x:Key="TealBrush" Color="{StaticResource MizzleTeal}"/>
    <SolidColorBrush x:Key="BlueBrush" Color="{StaticResource MizzleBlue}"/>
    <SolidColorBrush x:Key="PinkBrush" Color="{StaticResource MizzlePink}"/>
    <SolidColorBrush x:Key="DarkBg" Color="#FF282A36"/>
    <SolidColorBrush x:Key="PanelBg" Color="#FF1E1F29"/>
    <SolidColorBrush x:Key="BorderDim" Color="#FF333333"/>
    <SolidColorBrush x:Key="TextFg" Color="#FFEEEEEE"/>

    <!-- Button style: purple, rounded, glow on hover, press shrink -->
    <Style TargetType="Button">
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="Background" Value="{StaticResource PurpleBrush}"/>
      <Setter Property="Padding" Value="10,6"/>
      <Setter Property="Cursor" Value="Hand"/>
      <Setter Property="SnapsToDevicePixels" Value="True"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <Grid>
              <Border x:Name="bd" Background="{TemplateBinding Background}" CornerRadius="12" BorderThickness="0" Effect="{x:Null}">
                <ContentPresenter Margin="2" HorizontalAlignment="Center" VerticalAlignment="Center" RecognizesAccessKey="True"/>
              </Border>
            </Grid>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="bd" Property="Effect">
                  <Setter.Value>
                    <DropShadowEffect ShadowDepth="0" BlurRadius="16" Opacity="0.6" Color="{StaticResource MizzleBlue}"/>
                  </Setter.Value>
                </Setter>
              </Trigger>
              <Trigger Property="IsPressed" Value="True">
                <Setter TargetName="bd" Property="RenderTransform">
                  <Setter.Value>
                    <ScaleTransform ScaleX="0.98" ScaleY="0.98"/>
                  </Setter.Value>
                </Setter>
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.6"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- TextBox style: bottom border; blue on focus -->
    <Style TargetType="TextBox">
      <Setter Property="Background" Value="{StaticResource PanelBg}"/>
      <Setter Property="Foreground" Value="{StaticResource TextFg}"/>
      <Setter Property="BorderBrush" Value="{StaticResource BorderDim}"/>
      <Setter Property="BorderThickness" Value="0,0,0,2"/>
      <Setter Property="Padding" Value="6,6,6,6"/>
      <Setter Property="SelectionBrush" Value="{StaticResource BlueBrush}"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="TextBox">
            <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
              <ScrollViewer x:Name="PART_ContentHost"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsKeyboardFocusWithin" Value="True">
                <Setter Property="BorderBrush" Value="{StaticResource BlueBrush}"/>
              </Trigger>
              <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Opacity" Value="0.6"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <!-- RichTextBox style for Results -->
    <Style x:Key="ResultsStyle" TargetType="RichTextBox">
      <Setter Property="Background" Value="#FF0E0E0E"/>
      <Setter Property="BorderBrush" Value="{StaticResource BorderDim}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="Foreground" Value="{StaticResource TextFg}"/>
      <Setter Property="FontFamily" Value="Consolas"/>
      <Setter Property="FontSize" Value="12"/>
      <Setter Property="IsReadOnly" Value="True"/>
    </Style>
  </Window.Resources>

  <Grid Margin="12">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="8"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="8"/>
      <RowDefinition Height="220"/>
      <RowDefinition Height="8"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="Auto"/>
      <ColumnDefinition Width="Auto"/>
      <ColumnDefinition Width="*"/>
      <ColumnDefinition Width="260"/>
      <ColumnDefinition Width="320"/>
      <ColumnDefinition Width="Auto"/>
    </Grid.ColumnDefinitions>

    <!-- Header with centered title -->
    <Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="6">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="60"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>
      <Image x:Name="LogoLeft" Grid.Column="0" Height="44" Margin="0,0,8,0"/>
      <TextBlock Grid.Column="1" Text="Mizzle-AV - App Validation for Lab Dash" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="22" FontWeight="Bold" Foreground="{StaticResource PurpleBrush}"/>
      <Image x:Name="LogoRight" Grid.Column="2" Height="44" Margin="0,0,0,0" HorizontalAlignment="Right"/>
    </Grid>

    <!-- Column labels -->
    <TextBlock Grid.Row="2" Grid.Column="0" Text="#" Margin="0,0,8,2" Opacity="0.8" ToolTip="Row number"/>
    <TextBlock Grid.Row="2" Grid.Column="1" Text="Browse" Margin="4,0,8,2" Opacity="0.8" ToolTip="Pick an executable file"/>
    <TextBlock Grid.Row="2" Grid.Column="2" Text="Executable Path" Margin="4,0,8,2" Opacity="0.8" ToolTip="Full path to the application .exe"/>
    <TextBlock Grid.Row="2" Grid.Column="3" Text="App Name" Margin="4,0,8,2" Opacity="0.8" ToolTip="Display name; used to derive the link key"/>
    <TextBlock Grid.Row="2" Grid.Column="4" Text="Custom Arguments (optional)" Margin="4,0,8,2" Opacity="0.8" ToolTip="Arguments passed to the application on launch"/>
    <TextBlock Grid.Row="2" Grid.Column="5" Text="Test" Margin="4,0,8,2" Opacity="0.8" ToolTip="Quickly test this row's link"/>

    <!-- Row 1 -->
    <TextBlock Grid.Row="3" Grid.Column="0" Text="1" VerticalAlignment="Center"/>
    <Button x:Name="Browse1" Grid.Row="3" Grid.Column="1" Margin="4,2" Content="Browse"/>
    <TextBox x:Name="Path1" Grid.Row="3" Grid.Column="2" Margin="4,2"/>
    <TextBox x:Name="Name1" Grid.Row="3" Grid.Column="3" Margin="4,2"/>
    <TextBox x:Name="Args1" Grid.Row="3" Grid.Column="4" Margin="4,2"/>
    <Button x:Name="Test1" Grid.Row="3" Grid.Column="5" Margin="4,2" Content="Test" Width="70" ToolTip="Test this row's link"/>

    <!-- Row 2 -->
    <TextBlock Grid.Row="4" Grid.Column="0" Text="2" VerticalAlignment="Center"/>
    <Button x:Name="Browse2" Grid.Row="4" Grid.Column="1" Margin="4,2" Content="Browse"/>
    <TextBox x:Name="Path2" Grid.Row="4" Grid.Column="2" Margin="4,2"/>
    <TextBox x:Name="Name2" Grid.Row="4" Grid.Column="3" Margin="4,2"/>
    <TextBox x:Name="Args2" Grid.Row="4" Grid.Column="4" Margin="4,2"/>
    <Button x:Name="Test2" Grid.Row="4" Grid.Column="5" Margin="4,2" Content="Test" Width="70" ToolTip="Test this row's link"/>

    <!-- Row 3 -->
    <TextBlock Grid.Row="5" Grid.Column="0" Text="3" VerticalAlignment="Center"/>
    <Button x:Name="Browse3" Grid.Row="5" Grid.Column="1" Margin="4,2" Content="Browse"/>
    <TextBox x:Name="Path3" Grid.Row="5" Grid.Column="2" Margin="4,2"/>
    <TextBox x:Name="Name3" Grid.Row="5" Grid.Column="3" Margin="4,2"/>
    <TextBox x:Name="Args3" Grid.Row="5" Grid.Column="4" Margin="4,2"/>
    <Button x:Name="Test3" Grid.Row="5" Grid.Column="5" Margin="4,2" Content="Test" Width="70" ToolTip="Test this row's link"/>

    <!-- Row 4 -->
    <TextBlock Grid.Row="6" Grid.Column="0" Text="4" VerticalAlignment="Center"/>
    <Button x:Name="Browse4" Grid.Row="6" Grid.Column="1" Margin="4,2" Content="Browse"/>
    <TextBox x:Name="Path4" Grid.Row="6" Grid.Column="2" Margin="4,2"/>
    <TextBox x:Name="Name4" Grid.Row="6" Grid.Column="3" Margin="4,2"/>
    <TextBox x:Name="Args4" Grid.Row="6" Grid.Column="4" Margin="4,2"/>
    <Button x:Name="Test4" Grid.Row="6" Grid.Column="5" Margin="4,2" Content="Test" Width="70" ToolTip="Test this row's link"/>

    <!-- Row 5 -->
    <TextBlock Grid.Row="7" Grid.Column="0" Text="5" VerticalAlignment="Center"/>
    <Button x:Name="Browse5" Grid.Row="7" Grid.Column="1" Margin="4,2" Content="Browse"/>
    <TextBox x:Name="Path5" Grid.Row="7" Grid.Column="2" Margin="4,2"/>
    <TextBox x:Name="Name5" Grid.Row="7" Grid.Column="3" Margin="4,2"/>
    <TextBox x:Name="Args5" Grid.Row="7" Grid.Column="4" Margin="4,2"/>
    <Button x:Name="Test5" Grid.Row="7" Grid.Column="5" Margin="4,2" Content="Test" Width="70" ToolTip="Test this row's link"/>

    <!-- Results -->
    <GroupBox Grid.Row="9" Grid.Column="0" Grid.ColumnSpan="5" Header="Results" Margin="0,0,0,0"
              Foreground="{StaticResource TextFg}" BorderBrush="{StaticResource TealBrush}">
      <RichTextBox x:Name="ResultsRich" Style="{StaticResource ResultsStyle}"/>
    </GroupBox>

    <!-- Buttons + copyright -->
    <Grid Grid.Row="11" Grid.Column="0" Grid.ColumnSpan="6">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>

      <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="2,0,0,0">
        <TextBlock Foreground="{StaticResource TealBrush}" FontSize="11" FontWeight="SemiBold">
          <Hyperlink x:Name="LinkCopyright" NavigateUri="https://github.com/twinflamepartners" Foreground="{StaticResource TealBrush}">
            (c) Twinflame Partners 2025
          </Hyperlink>
        </TextBlock>
        <TextBlock x:Name="BuildInfo" Foreground="{StaticResource BorderDim}" FontSize="11" Margin="12,0,0,0" Text="v0.0.0"/>
      </StackPanel>

      <WrapPanel Grid.Column="1" HorizontalAlignment="Right">
        <Button x:Name="Validate"     Content="Validate"     Width="130" Margin="0,0,8,4" ToolTip="Validate paths and show labdash links"/>
        <Button x:Name="SaveJson"     Content="Save JSON"     Width="130" Margin="0,0,8,4" ToolTip="Append/update valid entries in apps.json"/>
        <Button x:Name="AppsReport"   Content="Apps Report"   Width="130" Margin="0,0,8,4" ToolTip="Open a consolidated report of apps.json"/>
        <Button x:Name="OpenJson"     Content="Open JSON"     Width="130" Margin="0,0,8,4" ToolTip="Open apps.json for editing"/>
        <Button x:Name="OpenLog"      Content="Open Log"      Width="130" Margin="0,0,8,4" ToolTip="Open the handler log file"/>
        <Button x:Name="ClearEntries" Content="Clear Entries" Width="130" Margin="0,0,8,4" ToolTip="Clear all fields and results"/>
        <Button x:Name="RemoveLink"   Content="Remove AppLink" Width="130" Margin="0,0,8,4" ToolTip="Remove the selected link from apps.json" Background="{StaticResource PinkBrush}"/>
        <Button x:Name="Close"        Content="Close"        Width="130" Margin="0,0,0,4" ToolTip="Close this window" Background="{StaticResource PinkBrush}"/>
      </WrapPanel>
    </Grid>

  </Grid>
</Window>
